So I just tried the recursive version, and I get a TLE.
â€‹
So think I need to use a stack.